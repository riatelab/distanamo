<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Distanamo: distance cartograms • distanamo</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Distanamo: distance cartograms">
<meta name="description" content="Creation of distance cartograms by deforming map layers to show the local deformations (computed using Waldo Tobler's bidimensional regression) between source points and image points.">
<meta property="og:description" content="Creation of distance cartograms by deforming map layers to show the local deformations (computed using Waldo Tobler's bidimensional regression) between source points and image points.">
<meta property="og:image" content="https://riatelab.github.io/distanamo/reference/figures/logo.png">
<meta property="og:image:alt" content="Distanamo logo">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">distanamo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/distanamo.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/with-osm-data.html">Creating a distance cartogram using OSM data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/riatelab/distanamo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="distanamo-">Distanamo <a class="anchor" aria-label="anchor" href="#distanamo-"></a>
</h1>
</div>
<!-- [![R-CMD-check](https://github.com/riatelab/distanamo/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/riatelab/distanamo/actions/workflows/R-CMD-check.yaml) -->
<p><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></p>
<p>This package allows you to create distance cartograms (or distance anamorphoses, hence the name).</p>
<p>Distance cartograms are a type of cartogram that deforms the layers of a map according to the distances between a set of source points and a set of image points.</p>
<p>This is done by extending (by interpolation) to the layer(s) of the study area (territorial divisions, network…) the local displacement between the source coordinates and the image coordinates, derived from the distances between each pair of homologous points (source / image points).</p>
<p>The relation between the source points and the image points, and thus the relative position of the image points compared to the source points, must depend on the studied theme (such as positions in access time for which this package provides some helper functions to generate the image points from the durations between the points).</p>
<p>Note that this package is more geared towards the creation of cartograms based on the bidimensional regression technique than specifically towards the study and comparison of two 2D configurations in order to assess their similarity. For this we recommend using the <a href="https://CRAN.R-project.org/package=BiDimRegression" class="external-link">BiDimRegression</a> package which is geared towards applying bidimensional regression in the area of psychological research, face research and comparison of 2D-data patterns in general. Other functionalities close to those proposed in this package (in particular concerning multidimensional scaling and the rotation/scaling/translating/reflection of one set of points to fit another) can also be found in the <a href="https://CRAN.R-project.org/package=vegan" class="external-link">Vegan</a> package for example.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install <code>distanamo</code> from <a href="https://riatelab.r-universe.dev/" class="external-link">riatelab’s R-universe</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'distanamo'</span>, repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'https://riatelab.r-universe.dev'</span>, <span class="st">'https://cloud.r-project.org'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, you can install the development version of <code>distanamo</code> from GitHub with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"riatelab/distanamo"</span><span class="op">)</span></span></code></pre></div>
<p>Note that to install from GitHub, you will need the <a href="https://rustup.rs/" class="external-link">Rust toolchain</a> to compile the Rust code and that the Minimum Supported Rust Version (MSRV) is 1.82.0.</p>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="section level3">
<h3 id="basics">Basics<a class="anchor" aria-label="anchor" href="#basics"></a>
</h3>
<p>To use this package you need to provide two sets of homologous points : <em>source points</em> and <em>image points</em>. They are used to create an interpolation grid that will be used to deform the layer(s) of interest.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read source points, image points and the background layer to deform</span></span>
<span><span class="va">source_pts</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span></span>
<span>  dsn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"gpkg/data-prefecture.gpkg"</span>, package <span class="op">=</span> <span class="st">"distanamo"</span><span class="op">)</span>,</span>
<span>  layer <span class="op">=</span> <span class="st">'prefecture'</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">image_pts</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span></span>
<span>  dsn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"gpkg/data-prefecture.gpkg"</span>, package <span class="op">=</span> <span class="st">"distanamo"</span><span class="op">)</span>,</span>
<span>  layer <span class="op">=</span> <span class="st">'image-points'</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">background_layer</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span></span>
<span>  dsn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"gpkg/data-prefecture.gpkg"</span>, package <span class="op">=</span> <span class="st">"distanamo"</span><span class="op">)</span>,</span>
<span>  layer <span class="op">=</span> <span class="st">'departement'</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">bbox</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">background_layer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the interpolation grid</span></span>
<span><span class="va">igrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dc_create.html">dc_create</a></span><span class="op">(</span><span class="va">source_pts</span>, <span class="va">image_pts</span>, <span class="fl">2.0</span>, <span class="va">bbox</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use it to deform our layer of interest</span></span>
<span><span class="va">deformed_background</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dc_interpolate.html">dc_interpolate</a></span><span class="op">(</span><span class="va">igrid</span>, <span class="va">background_layer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display useful information</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">igrid</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot information about the interpolation grid</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">igrid</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="adjusting-the-image-points-to-the-source-points">Adjusting the image points to the source points<a class="anchor" aria-label="anchor" href="#adjusting-the-image-points-to-the-source-points"></a>
</h3>
<p>In some cases, you may want to adjust the image points to the source points using an affine or a Euclidean transformation.</p>
<p>For example, here, if the image points represent locations in spatial cognition (and thus are not directly comparable to the source points, aren’t in the same coordinate system, etc.), you need to adjust them to the source points.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pos_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dc_adjust.html">dc_adjust</a></span><span class="op">(</span></span>
<span>    source_points <span class="op">=</span> <span class="va">source_pts</span>,</span>
<span>    image_points <span class="op">=</span> <span class="va">image_pts</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"euclidean"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the interpolation grid</span></span>
<span><span class="va">igrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dc_create.html">dc_create</a></span><span class="op">(</span></span>
<span>  <span class="va">pos_result</span><span class="op">$</span><span class="va">source_points</span>,</span>
<span>  <span class="va">pos_result</span><span class="op">$</span><span class="va">image_points</span>,</span>
<span>  <span class="fl">2.0</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This is also what is done internally when using the <code>dc_generate_positions_from_durations</code> function (see below) after it has performed a Principal Coordinates Analysis (PCoA) on the duration matrix.</p>
</div>
<div class="section level3">
<h3 id="generating-image-points-from-a-reference-point-and-travel-times-from-the-reference-point-to-all-the-other-points">Generating image points from a reference point and travel times from the reference point to all the other points<a class="anchor" aria-label="anchor" href="#generating-image-points-from-a-reference-point-and-travel-times-from-the-reference-point-to-all-the-other-points"></a>
</h3>
<p>Optionally you can provide a layer of source points and matrix of durations between the points.</p>
<p>This durations matrix will be used to extract the duration between a reference point and all the other points, allowing to use the <code>dc_move_from_reference_point</code> function to move closer / farther points from the reference point depending on if they can be reached faster or slower of the average speed (between the reference point and all the others).</p>
<p>The cartogram obtained by this method qualifies the <em>unipolar accessibility</em> of a location (the reference point used in the <code>dc_move_from_reference_point</code> function). It’s also sometimes referred to as a <em>centered time cartogram</em>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read source points and layer to be deformed</span></span>
<span><span class="va">source_pts</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span></span>
<span>  dsn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"gpkg/data-prefecture.gpkg"</span>, package <span class="op">=</span> <span class="st">"distanamo"</span><span class="op">)</span>,</span>
<span>  layer <span class="op">=</span> <span class="st">'prefecture'</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">background_layer</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span></span>
<span>  dsn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"gpkg/data-prefecture.gpkg"</span>, package <span class="op">=</span> <span class="st">"distanamo"</span><span class="op">)</span>,</span>
<span>  layer <span class="op">=</span> <span class="st">'departement'</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">bbox</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">background_layer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read durations between points</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"csv/mat.csv"</span>, package <span class="op">=</span> <span class="st">"distanamo"</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The CSV is a time matrix structured as follow</span></span>
<span><span class="co">#           AGEN   BORDEAUX   GRENOBLE etc.</span></span>
<span><span class="co"># AGEN      0.0    111.2      200.3</span></span>
<span><span class="co"># BORDEAUX  112.3  0.0        300.1</span></span>
<span><span class="co"># GRENOBLE  199.4  301.1      0.0</span></span>
<span><span class="co"># etc.</span></span>
<span><span class="va">dv</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">[</span><span class="st">'GRENOBLE'</span>, <span class="op">]</span></span>
<span><span class="co"># So we have only the duration between GRENOBLE and all the other points</span></span>
<span><span class="co">#          AGEN   BORDEAUX   GRENOBLE etc.</span></span>
<span><span class="co"># GRENOBLE 199.4  301.1      0.0</span></span>
<span></span>
<span><span class="va">source_pts</span><span class="op">$</span><span class="va">durations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">as.double</a></span><span class="op">(</span><span class="va">dv</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ref_point</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">source_pts</span>, <span class="va">source_pts</span><span class="op">$</span><span class="va">NOM_COM</span> <span class="op">==</span> <span class="st">"GRENOBLE"</span><span class="op">)</span></span>
<span><span class="va">other_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">source_pts</span>, <span class="op">!</span><span class="va">source_pts</span><span class="op">$</span><span class="va">NOM_COM</span> <span class="op">==</span> <span class="st">"GRENOBLE"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Move points to create the image points layer</span></span>
<span><span class="va">positioning_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dc_move_from_reference_point.html">dc_move_from_reference_point</a></span><span class="op">(</span></span>
<span>  reference_point <span class="op">=</span> <span class="va">ref_point</span>,</span>
<span>  other_points <span class="op">=</span> <span class="va">other_points</span>,</span>
<span>  duration_col_name <span class="op">=</span> <span class="st">"durations"</span>,</span>
<span>  factor <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the interpolation grid</span></span>
<span><span class="va">igrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dc_create.html">dc_create</a></span><span class="op">(</span></span>
<span>  <span class="va">positioning_result</span><span class="op">$</span><span class="va">source_points</span>,</span>
<span>  <span class="va">positioning_result</span><span class="op">$</span><span class="va">image_points</span>,</span>
<span>  <span class="fl">2.0</span>,</span>
<span>  <span class="va">bbox</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Deform the target layer</span></span>
<span><span class="va">deformed_background</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dc_interpolate.html">dc_interpolate</a></span><span class="op">(</span><span class="va">igrid</span>, <span class="va">background_layer</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">deformed_background</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>A popular way of representing this type of cartogram is to add concentric circles (separated by a constant time) around the reference point. This can be done using the <code>dc_concentric_circles</code> function and the result of the <code>dc_move_from_reference_point</code> function (note that the steps parameter is the travel time, in the same unit as the durations matrix, between each circle).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">circles</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dc_concentric_circles.html">dc_concentric_circles</a></span><span class="op">(</span></span>
<span>  <span class="va">pos_result</span>,</span>
<span>  steps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">60</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="generating-image-points-from-a-durations-matrix-between-all-the-points">Generating image points from a durations matrix between all the points<a class="anchor" aria-label="anchor" href="#generating-image-points-from-a-durations-matrix-between-all-the-points"></a>
</h3>
<p>Optionally you can provide a matrix of travel times between all the points as well as the positions of the source points and use the <code>dc_generate_positions_from_durations</code> function to generate the image points.</p>
<p>This function will perform Principal Coordinates Analysis (PCoA, a form a Multidimensional scaling) on the durations matrix to generate the positions of the points in a 2D space. It will then adjust these points (using an affine or a Euclidean transformation) to the source points to generate the final image points that can be used to create the interpolation grid.</p>
<p>The cartogram obtained by this method qualifies the <em>global accessibility</em> (or the <em>multipolar accessibility</em>) of a territory by visualizing the travel times between all pairs of locations.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read source points and layer to be deformed</span></span>
<span><span class="va">source_pts</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span></span>
<span>  dsn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"gpkg/data-prefecture.gpkg"</span>, package <span class="op">=</span> <span class="st">"distanamo"</span><span class="op">)</span>,</span>
<span>  layer <span class="op">=</span> <span class="st">'prefecture'</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">background_layer</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span></span>
<span>  dsn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"gpkg/data-prefecture.gpkg"</span>, package <span class="op">=</span> <span class="st">"distanamo"</span><span class="op">)</span>,</span>
<span>  layer <span class="op">=</span> <span class="st">'departement'</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read durations between points</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"csv/mat.csv"</span>, package <span class="op">=</span> <span class="st">"distanamo"</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># The CSV is a time matrix structured as follow</span></span>
<span><span class="co">#           AGEN   BORDEAUX   GRENOBLE etc.</span></span>
<span><span class="co"># AGEN      0.0    111.2      200.3</span></span>
<span><span class="co"># BORDEAUX  112.3  0.0        300.1</span></span>
<span><span class="co"># GRENOBLE  199.4  301.1      0.0</span></span>
<span><span class="co"># etc.</span></span>
<span></span>
<span><span class="va">pos_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dc_generate_positions_from_durations.html">dc_generate_positions_from_durations</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">source_pts</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display useful information about the result of the positioning</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pos_result</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pos_result</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the interpolation grid</span></span>
<span><span class="va">igrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dc_create.html">dc_create</a></span><span class="op">(</span></span>
<span>  <span class="va">pos_result</span><span class="op">$</span><span class="va">source_points</span>,</span>
<span>  <span class="va">pos_result</span><span class="op">$</span><span class="va">image_points</span>,</span>
<span>  <span class="fl">2.0</span>,</span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">background_layer</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">igrid</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">igrid</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Deform the target layer</span></span>
<span><span class="va">deformed_background</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dc_interpolate.html">dc_interpolate</a></span><span class="op">(</span><span class="va">igrid</span>, <span class="va">background_layer</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">deformed_background</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="deforming-multiple-layers-at-once">Deforming multiple layers at once<a class="anchor" aria-label="anchor" href="#deforming-multiple-layers-at-once"></a>
</h3>
<p>If you want to deform multiple layers in parallel with an interpolation grid, you can use the <code>dc_interpolate_parallel</code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_layers</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dc_interpolate_parallel.html">dc_interpolate_parallel</a></span><span class="op">(</span></span>
<span>  <span class="va">igrid</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">layer1</span>, <span class="va">layer2</span>, <span class="va">layer3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="float">
<img src="./reference/figures/ex-1.png" alt="Example of distance cartogram (Accessibility by bike from the center of Pithiviers)"><div class="figcaption">Example of distance cartogram (Accessibility by bike from the center of Pithiviers)</div>
</div>
<div class="float">
<img src="./reference/figures/ex-2.png" alt="Example of distance cartogram (Accessibility by car from Caen)"><div class="figcaption">Example of distance cartogram (Accessibility by car from Caen)</div>
</div>
<p><em>Maps made with <a href="https://github.com/riatelab/mapsf" class="external-link"><code>mapsf</code></a>.</em></p>
</div>
<div class="section level2">
<h2 id="more-information-about-the-origin-of-the-method">More information about the origin of the method<a class="anchor" aria-label="anchor" href="#more-information-about-the-origin-of-the-method"></a>
</h2>
<ul>
<li><p>This is a port of the <strong><a href="https://thema.univ-fcomte.fr/productions/software/darcy/" class="external-link">Darcy</a></strong> standalone software regarding the bidimensional regression and the backgrounds layers deformation.<br>
All credit for the contribution of the method goes to <strong>Colette Cauvin</strong> <em>(Théma - Univ. Franche-Comté)</em> and for the reference Java implementation goes to <strong>Gilles Vuidel</strong> <em>(Théma - Univ. Franche-Comté)</em>.</p></li>
<li><p>This method is also available as a <strong>QGIS plugin</strong> (<a href="https://github.com/mthh/QgisDistanceCartogramPlugin" class="external-link">GitHub repository</a> / <a href="https://plugins.qgis.org/plugins/dist_cartogram/" class="external-link">QGIS plugin repository</a>).</p></li>
<li><p>This R package is a wrapper around the Rust library <a href="https://github.com/mthh/distance-cartogram-rs" class="external-link"><code>distance-cartogram-rs</code></a> which can be used directly from Rust.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div class="section level3">
<h3 id="about-the-method">About the method<a class="anchor" aria-label="anchor" href="#about-the-method"></a>
</h3>
<ul>
<li><p>Cauvin, C. (2005). A systemic approach to transport accessibility. A methodology developed in Strasbourg: 1982-2002. Cybergeo: European Journal of Geography. DOI: <a href="https://doi.org/10.4000/cybergeo.3425" class="external-link">10.4000/cybergeo.3425</a>.</p></li>
<li><p>Cauvin, C., &amp; Vuidel, G. (2009). Darcy 2.0 - Mode d’emploi (<a href="https://thema.univ-fcomte.fr/productions/software/darcy/download/me_darcy.pdf" class="external-link uri">https://thema.univ-fcomte.fr/productions/software/darcy/download/me_darcy.pdf</a>).</p></li>
<li><p>Tobler, W. R. (1994). Bidimensional regression. Geographical Analysis, 26(3), 187-212. DOI: <a href="https://doi.org/10.1111/j.1538-4632.1994.tb00320.x" class="external-link">10.1111/j.1538-4632.1994.tb00320.x</a></p></li>
<li><p>Bronner, A. C. (2023). Cartogrammes, anamorphoses : des territoires transformés. In Traitements et cartographie de l’information géographique, ISTE Group (pp.231-271). DOI: <a href="https://doi.org/10.51926/ISTE.9161.ch7" class="external-link">10.51926/ISTE.9161.ch7</a>.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="about-distance-or-time-cartograms-in-general-their-usability-the-other-methods-to-create-them-etc">About distance (or time) cartograms in general: their usability, the other methods to create them, etc.<a class="anchor" aria-label="anchor" href="#about-distance-or-time-cartograms-in-general-their-usability-the-other-methods-to-create-them-etc"></a>
</h3>
<ul>
<li><p>Ullah, R., Mengistu, E., van Elzakker, C. &amp; Kraak, M. (2016). Usability evaluation of centered time cartograms. Open Geosciences, 8(1), 337-359. DOI: <a href="https://doi.org/10.1515/geo-2016-0035" class="external-link">10.1515/geo-2016-0035</a>.</p></li>
<li><p>Hong, S., Kim, Y. S., Yoon, J. C., &amp; Aragon, C. (2014). Traffigram: distortion for clarification via isochronal cartography. In Proceedings of the SIGCHI Conference on Human Factors in Computing Systems (pp. 907–916). Association for Computing Machinery. DOI: <a href="https://doi.org/10.1145/2556288.2557224" class="external-link">10.1145/2556288.2557224</a>.</p></li>
<li><p>Ullah, R., Kraak, M. J., &amp; Van Elzakker, C. (2013). Using cartograms to explore temporal data: do they work. GeoViz, 2013.</p></li>
<li><p>Ullah, R., &amp; Kraak, M. J. (2014). An alternative method to constructing time cartograms for the visual representation of scheduled movement data. Journal of Maps, 11(4), 674–687. DOI: <a href="https://doi.org/10.1080/17445647.2014.935502" class="external-link">10.1080/17445647.2014.935502</a>.</p></li>
<li><p>Hong, S., Kocielnik, R., Min-Joon Yoo, Battersby, S., Juho Kim, &amp; Aragon, C. (2017). Designing interactive distance cartograms to support urban travelers. In 2017 IEEE Pacific Visualization Symposium (PacificVis) (pp. 81-90).</p></li>
<li><p>Shimizu, E. and Inoue, R. (2009). A new algorithm for distance cartogram construction. International Journal of Geographical Information Science 23(11): 1453-1470. DOI: <a href="https://doi.org/10.1080/13658810802186882" class="external-link">10.1080/13658810802186882</a>.</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p><strong>GPL-3.0</strong></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/riatelab/distanamo/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/riatelab/distanamo/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing distanamo</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Matthieu Viry <br><small class="roles"> Maintainer, author </small> <a href="https://orcid.org/0000-0002-0693-8556" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthieu Viry.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
